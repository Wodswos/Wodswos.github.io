# 基本概念

显然，一元函数 $f(x)$ 可以理解为某多元函数如 $f(x,y,z)$ 令变量 $y,z$ 取某一常数的特例。所以，多元函微积分是一元函数微积分的扩展。

## 万物起源：极限

### $\epsilon - \delta$ 语言

设二元函数 $f(P) = f(x,y)$ 的定义域为 $D$，$P_0(x_0,y_0)$ 是 $D$ 的聚点，如果存在常数 $A$，对于任意给定的正数 $\epsilon$，总存在正数 $\delta$，使得当点 $P(x,y) \in D \cap \mathring U (P_0,\delta)$ 时，都有
$$
\abs{f(P) - A} = \abs {f(x,y) - A} < \epsilon
$$
成立，那么就称常数A为函数 $f(x,y)$ 当 $(x,y) \to (x_0, y_0)$ 时的极限，记作
$$
\lim _{(x,y) \to (x_0,y_0)} f(x,y) = A
$$

> 算是初步体会到邻域这个概念的妙处了，能用数学的语言精确定义任意元函数某一点的极限。

一元函数的极限只需考虑左右两个方向，但对于多元函数某一点的极限，其逼近的方向显然远不止两个（邻域不再是线而是面了），如下例
$$
\lim_{x\to 0 ,y\to 0} \frac{x^2y^2} {(x^2+y^2)^2}
$$
令 $y = kx$，表示从直线 $y=kx$ 的方向逼近求极限，可得：
$$
\lim _{x\to 0, y \to 0} \frac {x^2 \cdot kx^2} {(x^2+k^2x^2)^2} =\frac {k^2} {(1+k^2)^2}
$$
显然，最终的极限值与逼近方向有关，即不同方向的极限值不同，故极限不存在。



### 连续

和一元函数一样，若函数在点 $(x_0,y_0)$ 极限存在，且 $f(x_0, y_0) = \lim_ {x\to 0,y\to 0} f(x,y)$，则称多元函数在该点连续。



例题：证明下述函数在点 $(0,0)$ 处连续
$$
f(x,y) = 
\begin{cases}
\frac {x^2y^2}{(x^2+y^2)^{\frac 3 2}} , &(x,y) \ne (0,0) \\
0, &(x,y) = (0,0)
\end{cases}
$$
提示：均值不等式，化分子乘积为和式。



## 偏导数和全微分

> 一般来说，可导指的是偏导数存在，可微指的是全微分存在。

### 偏导数：一元导数

> 正如之前所言，一元函数 $f(x)$ 可以理解为某多元函数如 $f(x,y,z)$ 令变量 $y,z$ 取某一常数的特例。现在要研究多元函数了，那之前对一元函数这个“特例”的研究能不能给我们一些启发和帮助呢？之前“研究成果”能不能借鉴一下呢？
>
> 当然可以，就是偏导数

一元函数的导数一般以x轴正向为方向，但对于多元函数，方向显然太多了。

但是！学过线性代数就不难发现，一个面内的任意方向都可以通过该面内两个不平行的向量（基）线性组合得到。





比如先令 $y = y_0$ ，从x轴的方向求导数，此时二元函数在x轴方向的偏导数
$$
f'_x(x_0,y_0)  = \lim _{\Delta x \to 0} \frac {f(x_0+\Delta x ,y_0) - f(x_0,y_0)} {\Delta x}
$$
再令 $x = x_0$，得到 y 轴方向的偏导数
$$
f'_y(x_0,y_0)  = \lim _{\Delta y \to 0} \frac {f(x_0 ,y_0 + \Delta y) - f(x_0,y_0)} {\Delta y}
$$






例题：求如下函数的偏导数
$$
f(x,y) = 
\begin{cases}
\frac {x^2y^2}{(x^2+y^2)^{\frac 3 2}} , &(x,y) \ne (0,0) \\
0, &(x,y) = (0,0)
\end{cases}
$$
提示：也没啥可提示的，只要你对自己的关于偏导数的理解够自信，大胆填0



#### 可导不一定连续



#### 偏微分：还是线性代换，以平代曲

> 偏微分的“偏”英文是partial，但符号 $\partial$ 读作“round”

* 以平代曲（以长方代曲）

在一元函数中，微分的意义是以直代曲，$\mathrm dy \approx f'(x) \mathrm d x$（$\mathrm d y$ 和 $f'(x)\mathrm dx$ 两者往往相差一个高阶无穷小）。

多元函数同样如此，如二元函数的以直代曲，（两者相差高阶无穷小）。



一元函数的导数是切线的斜率。

二元函数的偏导数 $f'_x(x_0,y_0)$是点 $(x_0,y_0)$ 的**切平面**和平面 $y = y_0$ 的交线的斜率，同理，$f'_y(x_0,y_0)$ 是**切平面**和平面 $x= x_0$ 的交线的斜率。

（切平面，顾名思义，点 $(x_0, y_0)$ 的所有切线汇成的面）



#### 高阶偏导数

函数的高阶偏导数的复合结构图和函数一样。（当然俺并不会证明，知其然不知其所以然）

二阶偏导连续意味着可交换变元的求导次序。



### 可偏导 ≠ 可全微

> **多元函数的可导一般指可偏导，可微一般指可全微。**

**对于一元函数而言，没有“偏”和“全”的概念之分，自然有可导必可微，可微必可导。**

一元函数导数定义为
$$
f'(x)=\lim_{\Delta x} \frac {\Delta y}{ \Delta x} 
= \lim _{\Delta x \to 0} \frac {f(x + \Delta x) - f(x)} {\Delta x}
$$
函数可导即等价于上述极限存在，设上述极限（导数值）为$A$ ，只需简单移项，则可得到微分：
$$
\Delta y = A \Delta x + o(\Delta x) \approx A\Delta x\\ 
 \mathrm d y = A\mathrm dx
$$
反向同理，都是非常自然的过程，以至于导数和微分就像是一个硬币的正反面那么密切。



对于多元函数则不同，偏导数定义为：
$$
f'_x(x_0,y_0) = \lim _{\Delta x \to 0} \frac {f(x_0+\Delta x ,y_0) - f(x_0,y_0)} {\Delta x} \\
f'_y(x_0,y_0) = \lim _{\Delta y \to 0} \frac {f(x_0 ,y_0 + \Delta y) - f(x_0,y_0)} {\Delta y}
$$
全微分为：
$$
\Delta z = f(x_0 +\Delta x,y_0 + \Delta y) - f(x_0,y_0)
$$
那么如果偏导数已经存在了，全微分能不能化成下面这种形式呢
$$
\Delta z = A \Delta x + B\Delta y + o(\sqrt{{\Delta x}^2 + {\Delta y}^2})
$$
很遗憾，不一定。某一点的微分可以展开为如下形式：
$$
\Delta z &= f(x_0 +\Delta x,y_0 +\Delta y) - f(x_0,y_0 + \Delta y) + f(x_0,y_0 + \Delta y) - f(x_0,y_0) \\
&= f(x_0 +\Delta x,y_0 +\Delta y) - f(x_0 +\Delta x,y_0 ) + f(x_0 + \Delta x,y_0 ) - f(x_0,y_0)
$$
 $f(x_0,y_0 + \Delta y) - f(x_0,y_0)$ 显然可以表示成 $B \Delta y$，但可惜 $f(x_0 +\Delta x,y_0 +\Delta y) - f(x_0,y_0 + \Delta y)$ 却不能表示成 $A \Delta x$ （如果能保证多元函数连续，倒是可以让等式成立），另一个等式情况类似。



还是以那个熟悉的函数表达式[^1]为例：
$$
f(x,y) = 
\begin{cases}
\frac {x^2y^2}{(x^2+y^2)^{\frac 3 2}} , &(x,y) \ne (0,0) \\
0, &(x,y) = (0,0)
\end{cases}
$$
该函数在点 $(0,0)$ 处连续，且偏导数存在，但全微分不存在。



#### 偏导连续得可微

**偏导数在点 $(x_0,y_0)$ 处连续，则函数在该点可微。**

对于如下微分形式，
$$
\Delta z = f(x_0 +\Delta x,y_0 +\Delta y) - f(x_0,y_0 + \Delta y) + f(x_0,y_0 + \Delta y) - f(x_0,y_0)
$$
之前说可导≠可微，是因为如果可导，对于上式我们能保证 $f(x_0,y_0 + \Delta y) - f(x_0,y_0) = B \Delta y$ ，却不能保证 $f(x_0 +\Delta x,y_0 +\Delta y) - f(x_0,y_0 + \Delta y) = A \Delta x$ ，但如果偏导数连续，则有
$$
\lim _{\Delta y \to 0}f_y ' (x_0  , y_0 + \Delta y)  = f' _y(x_0,y_0) = A
$$
从而有
$$
f(x_0 +\Delta x,y_0 +\Delta y) - f(x_0,y_0 + \Delta y) = \Delta x \cdot f_y'(x_0, y_0 + \Delta y) =A \Delta x
$$

故可微。



#### 全导数





## 方向导数和梯度






## 从一元到二元

### 从切线到切面





### 从斜率到向量









### 线性组合？

先看怎么定义：
$$
\Delta z = f(x+\Delta x, y +\Delta y ) - f(x,y)\\

\Delta z = A \Delta x + B\Delta y +o(\sqrt{{\Delta x}^2 +{\Delta y}^2}) 
$$
抛弃掉高阶无穷小（误差），取线性主部（微分），即得
$$
\mathrm d z = A\mathrm dx + B\mathrm dy = f'_x(x,y )\mathrm d x + f'_y(x,y) \mathrm d y
$$
再看怎么理解：



偏微分（线性代换） + 线性组合 = 全微分（还是线性代换）







## 小结



### 逻辑链条

用visio画的图，但没有完全完。



### 直观理解

之前一直提到的那个函数的图像大致是这样子的（GeoGebra作图）：

![image-20211001171315103](C:\Users\Five\Desktop\note\img\image-20211001171315103.png)



# 计算

## 复合求导



还是链式求导规则：
$$
\frac {\partial z} {\partial x} = \sum _{i=1} ^n \frac {\partial z} {\partial u_i}\frac {\partial u_i} {\partial x}
$$
变量间的复合结构图有点像神经网络（而且还都是传递的）：

> 直观来讲，$\frac {\partial z}{\partial x}$ 理解为x对z的权重，$\frac {\partial z} {\partial u_i}$ 为中间变量 $u_i$ 对 z 的权重，$\frac {\partial u_i} {\partial x}$ 为x对中间变量 $u_i$ 的权重。故有 $\frac {\partial z} {\partial x} = \sum _{i=1} ^n \frac {\partial z} {\partial u_i}\frac {\partial u_i} {\partial x}$

![image-20211001175024596](C:\Users\Five\Desktop\note\img\image-20211001175024596.png)

上述复合结构图的偏导为
$$
\frac {\partial z} {\partial x} = 
\frac {\partial z} {\partial u}  \frac{ \partial u }{\partial x} +
\frac {\partial z} {\partial v}  \frac{ \partial v }{\partial x} + 
\frac {\partial z} {\partial w}  \frac{ \partial w }{\partial x} \\

\frac {\partial z} {\partial y} = 
\frac {\partial z} {\partial u}  \frac{ \partial u }{\partial y} +
\frac {\partial z} {\partial v}  \frac{ \partial v }{\partial y} + 
\frac {\partial z} {\partial w}  \frac{ \partial w }{\partial y}
$$




### 隐函数求导

公式可由复合求导推导而来

对于方程 $F(x,y,z) = 0$ ，用 $x,y$ 表示 $z$，得到一个恒为0的函数 $F = F(x,y,z(x,y)) = 0$，然后两边对 $x$ 求导可得
$$
\frac {\partial F} {\partial x} = F'_x + F'_z \frac {\partial z} {\partial x}  = 0\\
\frac {\partial z} {\partial x} = - \frac {F'_x} {F'_z}
$$
一般题目中直接用公式会比复合求导更快。

更复杂的方程组情形：
$$
\begin{cases}
F(x,y,u,v) = 0 \\
G(x,y,u,v) = 0
\end{cases}
$$
求偏导 $\frac {\partial u} {\partial x}$。类似的，将



## 例题

例1：设 $F(u,v)$ 二阶偏导连续，并设 $z = F(\frac y x, x^2+y^2)$，求 $\frac {\partial^2 z} {\partial x \partial y}$.

二阶偏导连续意味着可交换变元的求导次序。

# 几何应用





## 极值/最值

必要条件：
$$
\begin{cases}
f'_x(x_0,y_0) = 0 \\
f'_y(x_0,y_0) = 0
\end{cases}
$$
充分条件：
$$
极小值
\begin{cases}
f_{xx} > 0 \\
f_{xx}f_{yy} -f_{xy}^2 >0
\end{cases}

\\
极大值
\begin{cases}
f_{xx} < 0 \\
f_{xx}f_{yy} -f_{xy}^2 > 0
\end{cases}
\\
$$
若 $f_{xx}f_{yy} -f_{xy}^2 > 0$ ，则该点非极值点。

### 条件最值

求 $u = f(x,y)$ 再约束条件 $\varphi(x,y) = 0$ 下的最值。

作辅助函数 $F(x,y,z) = f(x,y) + \lambda \varphi(x,y)$ 
$$
\begin{cases}
F'_x = 0 \\
F'_y = 0 \\
F'_z = 0

\end{cases}
$$


## 例题

设 $z = z (x,y)$ 是由 $x^2 - 6xy + 10 y^2 -2yz -z^2 +32 =0$ 确定的，求 $z = z(x,y)$ 的极值。

也没啥技巧，就算。先求 $\frac {\partial z}{\partial x},\frac {\partial z}{\partial y}$ ，再求二阶偏导，就是计算量略大



已知矩形周长为 $2p$，将其绕一边旋转一周构成一个圆柱体，求半径和高为多少时，体积最大。

约束条件 $x+y=p$. 目标$V = \pi x^2 y$



[^1]: 张宇考研数学全程班

