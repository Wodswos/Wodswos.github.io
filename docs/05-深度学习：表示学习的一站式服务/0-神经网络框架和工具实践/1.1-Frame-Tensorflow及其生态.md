



# TensorBoard

##



# Models





# TFX

ML is more than a framework

Google的Paper《TFX:A TensorFlow-Based Production-Scale Machine Learning Platform》，可以在谷歌学术找到并下载。

这应该是我读完的第一篇论文，虽然没啥学术性，下文基本就是对文章的摘录

> We present TensorFlow Extended (TFX), a TensorFlowbased general-purpose machine learning platform implemented at Google. By integrating the aforementioned components into one platform, we were able to standardize the components, simplify the platform configuration, and reduce the time to production from the order of months to weeks, while providing platform stability that minimizes disruptions.

## Introduction

机器学习对于现代计算的重要性怎么强调都不为过。（`ranging from`）从推荐系统到广告的点击率预测，甚至是濒危物种的保护，在`a board spectrum of use cases and products`，越来越多的组织采用机器学习作为从海量数据中获取知识的工具。

概念性地描述某一模型机器学习的过程是很简单的，无非

* `traing phase: a learner takes a dataset as input and emits a model`
* `inference phase: the model learner emits takes feature as input and emits prediction`

然而，在生产环境中，部署一个机器学习模型，其复杂度会陡增。因为需要考虑方方面面的因素，而模型只是整个`platform`很核心却也很小的一部分。

![人间真实](C:\Users\Five\Desktop\note\img\image-20201124202207311.png)

在实践中常常用`glue code`或者`custome scripts`连接这些部分，这会导致系统复杂度（耦合）很高，很难维护（`fragile`），当数据变化或者模型变化时，都要重新构建系统，导致很多重复劳动。

而TFX就是`one implementation of such a platform that we built at Google to address the aforementioned challenges.`

即提供了一种`end-to-end`的解决方案，标准化了机器学习系统的各个组件。

## Platform Overview

论文惯例，先介绍在TFX之前的一些工作（第一次用Google Scholar，真香）

* 《MLlib: Machine Learning in Apache Spark》
* 《A survey of open source tools for machine learning with big data in the Hadoop ecosystem》
* 《KeystoneML: Optimizing Pipelines for Large-Scale Advanced Analytics》
* 等等

TFX的设计遵循如下原则

* `One machine learning platform for many learning tasks`
* `Continuous Training`
* `Easy-to-use configuration and tools `
  * `A TFX user is only exposed to one common configuration`
* `Production-level reliablity and scalability`
  * `encapsulates the complexity of machine learning deployment`
  * `engineers and scientists have more time to focus on the modeling tasks`

> Our experience shows that the distributed data processing model offered by Apache Beam (and similar internal infrastructure) is a good fit for handling the large volume of data during training, model evaluation, and batch inference.
>
> 听这意思好像是俺还得去了解一下Beam，以前只是耳闻，未曾深入了解。

![image-20201124203018203](C:\Users\Five\Desktop\note\img\image-20201124203018203.png)

上图为一个通用机器学习平台的概览，也是TFX的设计概念。

（感觉论文后面都是对这幅图的详细解释罢了。）

## Data Analysis, Transformation, and Validation

对于实时的、流式的机器学习模型而言，数据质量的检验尤为重要，很小比例的不合格数据，在日积月累下都会对模型的质量造成客观的损伤。而这种质量的下降很不容易被发现，不同于`catastrophic bugs`那么好追踪。

`so constant data vigilance should be a part of any long running development of machine learning platform`

* 作为一个通用的ML平台，数据多种多样，因此需要`componenet`支持各种与模型相对应的数据分析和`validation`。
* 最好能够在不需要用户自定义的情况下即可面对大部分基础的`validation`和`analysis`
* 能够非侵入性地帮助用户监控并实时报告数据质量，报告要清晰可靠



### Data Validation

`examples of the properties that can be encoded in the schema:`

* Features presented in the data
* The expected type of each feature
* The expected presence of each feature
* The expected valency of the feature in each example
* 等等

难怪说预期Python，实际SQL……突然感觉Data Validation略水，连带着ML都觉得水了。

这有了TFX岂不是更水了，TFX全自动……

![](C:\Users\Five\Desktop\note\img\image-20201127210439082.png)

关于`anomal`数据的处理

* The user should understand at a glance which anomlies are detected.
* Each anomaly should have a simple description that helps the user to understand.
* Generates for each anomaly a corresponding schema change that can bring the schema up-to-date 
* We want the user to treat data errors with the same rigor and care that they deal with bugs in code



## Model Training

**`One of the core design philosophies of TFX is to streamline (and automate as much as possible) the process of training production quality models which can support all training use cases.`**

### Warm-Starting

`At Google, we have, on several occasions, leveraged warm-starting to attain high quality models without spending too many resources.`

**The trade-off between model quality and model freshness.**

温启动是一种实用的技术，如果`used correctly`，可以用更少的时间和更少的资源获得相同质量的模型。

温启动受到`transfer learning`（迁移学习）的启发。

`When training a new version of the network, we initialize (or warm-start) the parameters corresponding to these features from the previously trained version of the network and fine tune them with the rest of the network. `



## Model Evaluation and Validation

一个`Good model`需要具备的条件

* `safe to serve`
* `has the desired prediction quality`



`Evaluation: human-facing metrics of model quality`

`Validation: Machine-faceing judgment of model goodness`





## Case Study: Google Play

将TFX用于Google Play的推荐系统，既减少了`technical debt`（或许可以翻成“历史遗留问题”？），还提高了模型质量。

* The data validation and annalisis component helped in discovering a harmful training-serving feature skew.
* Warm-starting helped improve model quality and freshness while reducing the time and resources spent on training over hundreds of billions of examples.
* Model validation helped in understanding and troubleshooting performance differences between the old and new models. 
* The model serving component enabled deploying the trained model to production, while guaranteeing high performance and flexibility.





# Colab

Colaboratory简称Colab，Google Research团队开发的一款产品（所以域名也是colab.research.google.com）。

从技术上来说，Colab 是一种托管式 Jupyter 笔记本服务。





## 一些Feature

* Interactive Table
* Execution History
* Command Palette
