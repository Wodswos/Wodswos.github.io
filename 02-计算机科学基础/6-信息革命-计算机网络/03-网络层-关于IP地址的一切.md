![](C:/Users/Five/Desktop/note/img/705728-20160424234826351-1957282396.png)

![](C:/Users/Five/Desktop/note/img/705728-20160424234827195-1493107425.png)

# IP地址



## IP地址划分



### 特殊ip地址

* 0.0.0.0

可以代表所有本机IP地址：127.0.0.1 && 本机内网IP地址 && 本机公网IP地址（如果有的话）

如果想让整个公网能够访问，显然该端口必须绑定在公网IP地址或者0.0.0.0



* 127.0.0.1

本地回环地址，显然只有自己这台机器能够访问，其他机器用这个地址访问的显然是他们自己



* `netstat -nltp`命令显示的`::`是ipv6的表示方法，[::]就是全0的ip，相当于是ipv4中的0.0.0.0





* 公网IP和私有ip

私有网段地址：10/8，172.16/12，192.168/16这几个网段的地址。这些地址所在的主机，不能用这些地址面向internet，必须被一个网关隔离在私有域内。



所有使用私有地址的终端，要想和网关外的主机通信，必须用NAT，PROXY或者隧道技术进行地址转换，以使得对方回复过来的数据包可以在internet上转发



FAQ：

问：自己IP为100.64.0.30,理论上我可以和100.64.0.1-100.64.0.254这些上网的家庭用户直接网卡对网卡通信而不需要经过路由么?

答：有可能。前提是分配给你的子网掩码是255.255.255.0，而且没有使用其它隔离技术。不过实际情况下几乎不会有这种情况发生。我们会直接用一种叫VLAN的技术，使每个用户相互之间都无法访问。（vlan中文名叫虚拟局域网，就是接入设备在用户数据包上加个vlan数值，设备根据这个值是否相同来决定能否让用户互通，通常每个用户用一个数值，大家互不重复）



问：如果我用路由器,那么路由器下的IP比如192.168.1.101是不是就是内网IP,而路由器分配的100.64.0.30这个IP是外网IP?是不是外部只能访问到路由器,如果不用端口映射是访问不到192.168.1.101这个IP?

答：你前2个猜测都正确。第3个感觉不精确，应该是用NAT这种技术。

（NAT中文名字叫网络地址翻译，简单讲就是数据经过路由器时，路由器充当内外网的翻译，通过修改数据包的源地址或目的地址使内外网能互通，端口映射属于一种NAT实现方式。感谢知友提醒。）





通常内网和外网这种表述是相对的，而不是绝对的：

物理机所在的wifi网络相对于虚拟机和物理机通过NAT连接构成的网络而言是外网，但相对于整个互联网而言却是内网。

（甚至可能你的路由器所在的网络也不是互联网，而是供应商的提供的通过NAT共享一个公网IP的私网，毕竟公网IP稀缺）



而私网和公网（局域网和互联网）的概念较为固定，更好理解。



详细私网IP列表

| Address/Block | Name                      | RFC                        |
| ------------- | ------------------------- | -------------------------- |
| 0.0.0.0/8     | This host on this network | [RFC1122], section 3.2.1.3 |
| 10.0.0.0/8    | Private-Use               | [RFC1918]                  |
| 100.64.0.0/10 | Shared Address Space      | [RFC6598]                  |
| 127.0.0.0/8   | Loopback                  | [RFC1122], section 3.2.1.3 |
|               |                           |                            |



169.254.0.0/16 Link Local [RFC3927]

172.16.0.0/12 Private-Use [RFC1918]

192.0.0.0/24[2] IETF Protocol Assignments [RFC6890], section 2.1

192.0.0.0/29 IPv4 Service Continuity Prefix [RFC7335]

192.0.0.8/32 IPv4 dummy address [RFC7600]

192.0.0.9/32 Port Control Protocol Anycast [RFC-ietf-pcp-anycast-08]

192.0.0.170/32, 192.0.0.171/32 NAT64/DNS64 Discovery [RFC7050], section 2.2

192.0.2.0/24 Documentation (TEST-NET-1) [RFC5737]

192.31.196.0/24 AS112-v4 [RFC7535]

192.52.193.0/24 AMT [RFC7450]

192.88.99.0/24 Deprecated (6to4 Relay Anycast) [RFC7526]

192.168.0.0/16 Private-Use [RFC1918]

192.175.48.0/24 Direct Delegation AS112 Service [RFC7534]

198.18.0.0/15 Benchmarking [RFC2544]

198.51.100.0/24 Documentation (TEST-NET-2) [RFC5737]

203.0.113.0/24 Documentation (TEST-NET-3) [RFC5737]

240.0.0.0/4 Reserved [RFC1112], section 4

255.255.255.255/32 Limited Broadcast [RFC919], section 7 





* 子网掩码

* * 用来指明一个IP地址的哪些位标识的是主机所在的子网，以及哪些位标识的是主机

* * * 将某个IP地址划分成网络地址和主机地址两部分
    * 每类网络都有默认的掩码：A类为8，依此类推

* * 所以子网只是将某个A/B/C类进一步划分？

* * * 并没有增加ip地址数量，只是使得ip地址更好地分配了？
    * 比如原来一个A类网络给一个公司/单位，现在能通过子网掩码分配给不同单位了是嘛？
    * 使得每个网络的利用率更高了，而不是增多了可能性

* * 同网段，不用IP，用arp+Mac地址表 ？

* * * 还在消化这一点

![image](https://cdn.nlark.com/yuque/0/2021/png/21594955/1621319056162-7830c2b1-2aa2-4b24-8735-cf7d7fa4b690.png)

![image](https://cdn.nlark.com/yuque/0/2021/png/21594955/1621319056287-3154aa62-5b19-4b8f-8235-ab2e93f31843.png)

![image](https://cdn.nlark.com/yuque/0/2021/png/21594955/1621319056379-8896c410-fa4a-4e1b-b7ef-013554cefafd.png)



* IP地址类型

* * A、B、C类地址在ip地址的四段中前1、2、3段表示网络号码，后3、2、1段表示主机号码

* * * 所以A类ip地址默认子网掩码8，B类默认16，依此类推
    * 当将IP地址写成二进制形式时，A类地址的第一位总是0，B类地址的前两位是10，C类地址的前三位总是110

* * 子网使得A、B、C三类地址能够进一步细分，实现更自由/弹性的分配

![image](C:\Users\Five\Desktop\note\img\1621319056471-34fcab0a-c53b-4480-8aa0-e5e3700e5a5d.png)

# 配置IP地址[^1]

```bash
sudo ifconfig eth1 10.0.0.1/24
sudo ifconfig eth1 up
# 或者
sudo ip addr add 10.0.0.1/24 dev eth1
sudo ip link set up eth1
```

ip地址的配置这么随意吗？



# DHCP

Dynamic Host Configuration Protocol。





[^1]:《趣谈网络协议》 刘超
