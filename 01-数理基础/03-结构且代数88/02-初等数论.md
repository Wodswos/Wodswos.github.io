数论是研究数的规律，特别是整数性质的数学分支。她非常古老却又始终充满青春活力。[^4]数论留下了许多经典的问题和猜想，无论是哥德巴赫猜想还是黎曼猜想，总是吸引着世人的目光。

事实上，在每个数学领域都有着无数待解决的难题[^6]，而与其他领域不同，数论仅从最简单的整数出发（路人也能看懂题面），便引出了各种各样的难题，嘲弄着人类的智力。



# 素数及其基本定理

> 符号“|”表示整除，“a|b”表示b能被a整除。



**定理1**[^4]（算数基本定理）：设a>1，则有
$$
a=p_1^{r_1}p_2^{r_2}\dots p_k^{r_k}=\prod_{i=1}^k p_i^{r_i}
$$
其中$p_1,p_2,\dots,p_k$是不同的素数，$r_1,r_2,\dots,r_k$是正整数。

定理中的表达式称作$a$的素因子分解。



> **定理2**[^4]：有无穷多个素数。可用反证法证明。

> **定理3**[^4]：如果$a$是一个合数，则$a$必有一个小于等于$\sqrt a$的真因子。可用于简化素数测试。



**定理4**[^4]：素数定理，$\pi(n)$表示小于$n$的素数个数，有如下关系式：
$$
\lim_{n\rightarrow+\infty} \frac{\pi(n)}{n/\ln n} =1
$$

## 素数定理的简单证明[^5]

如果有空学了复变或者去看那个据说“奇淫巧计”的初等数论证明方法，再说证明吧……下面是尝试，显然失败了。

### 先验内容

在最开始，我们已知的，或者说能借助的，只有算数基本定理：
$$
a=p_1^{r_1}p_2^{r_2}\dots p_k^{r_k}=\prod_{i=1}^k p_i^{r_i}
$$
初看式子好像和$\pi(n)$八竿子打不着，但是，如果$p_1,p_2,\dots,p_k$是连续的，那岂不是就有$k=\pi(a)$了吗？

那么可以是连续的吗？或者说若$p_1,p_2,\dots,p_k$是连续的，此时$a$对应着哪个数呢？

我们可以退而求其次联想到阶乘。对于阶乘有：
$$
x\,|\,p_k! \Leftrightarrow 2 \leq x \leq p_k
$$
显然$1,2,\dots,p_k$都是$p_k!$的因子，自然也包括了$p_1,p_2,\dots,p_k$，再或者可以写成如下形式：
$$
p_k!=p_1^{r_1}p_2^{r_2}\dots p_k^{r_k}
$$
而此时，式中$\pi(p_k)=k$，

>1849年，著名天文学家 Encke 给高斯写信，讨论质数出现频率的问题。
>
>高斯回复道:这个问题很有意思!在57年前，也就是在我14岁的时候，偶然得到一本书。书上有一个对数表，还有一个质数表。闲来无事的我，花了一刻钟时间计算了其中1000个。发现了一个规律:质数的分布密度接近于自然对数的倒数，于是我又验算了大概一百万个，结论大体没错。

$$
\frac{\pi(x+t)-\pi(t)}t \approx \frac 1 {\ln x}
$$



## 梅森素数

近代已知已知的最大素数总是形如$2^n-1$的数，当$n$是合数时，$2^n-1$一定是合数。

设$p$为素数，形如$2^p-1$的数称为梅森素数。截至2013年初，共找到48个，最大的梅森素数时$2^{57885161}-1$[^4]。

当然现在已经找到了更多，第 51 个梅森素数有 24862048 位数字，名为 M82589933。



### 梅森素数和完全数

完全数：若一个数NN等与其所有非自身的约数之和，那么这个数就是完全数。

若$M_p$为梅森素数，那么$M_p2^{p−1}=\frac{M_p(Mp+1)}2$为完全数。

一个数的约数之和为2的幂次当且仅当它能被分解为不同梅森素数的乘积。



# 最大公约数

> C语言入门经典题，求两个非负整数的最大公约数。

**定理6**[^4]：设$a=qb+r$，其中$a,b,q,r$都是整数，则$\gcd(a,b)=\gcd(b,r)$

对于$a,b$的任意公因子$x$：
$$
\begin{align}
 (x|a) \and (x|b)
& \Rightarrow (x|b) \and (x|(qb+r)) \\
& \Rightarrow (x|qb) \and (x|r) \and (x|b)\\
& \Rightarrow (x|r) \and (x|b)
\end{align}
$$
可以得到$x$同时也为$b,r$的公因子。**定理6**得证。

## 辗转相除法

由**定理6**可得辗转相除法：
$$
\gcd(a,b)=\gcd(b,r_2)=\dots=\gcd(r_{k-1},r_k)=r_k
$$
算法流程图：

```flow
start=>start: Input a,b (a>b)
cond=>condition: a mod b = 0?
operation1=>operation: (a,b)=(b,a%b)
e=>end: 最大公约数为b

start->cond
cond(no)->operation1->cond
cond(yes)->e
```

关于辗转相除法，还有巧妙的[图解视频](https://www.bilibili.com/video/BV1mJ411q7xw)

## 裴蜀定理

> 一般地，对于方程$ax+by=m(a,b,m \in Z)$，$x,y$有整数解$\Leftrightarrow \gcd(a,b)|m$。
>
> 即$左边 \Leftrightarrow(\gcd(a,b)|ax) \and (\gcd(a,b)|by) \and (x,y\in Z) \Leftrightarrow \gcd(a,b)|(ax+by)\Leftrightarrow \gcd(a,b)|m$.

**定理7**[^4]：（裴蜀定理）若$a$和$b$不全为$0$，则一定存在整数$x,y$，使得$\gcd(a,b)=xa+yb$。

记$a=r_0,b=r_1$，
$$
\begin{align}
&r_0=q_1r_1+r_2\\
&\dots \\
&r_i=q_{i+1}r_{i+1}+r_{i+2}\\
&\dots \\
&r_{k-2} = q_{k-1}r_{k-1}+r_{k} \\
&r_{k-1} = q_kr_k
\end{align}
$$
$\gcd(a,b)=r_k$，对上述最后第二个式子移项，并开始逐个回代（得名拓展欧几里得算法）
$$
\begin{align}
r_k & = r_{k-2}-q_{k-1}r_{k-1} \\
& = (r_{k-4}-q_{k-3}r_{k-3}) -q_{k-1}(r_{k-3}-q_{k-2}r_{k-2}) \\
& = \dots
\end{align}
$$
不断回代，最终$\gcd(a,b)$可以表示成$r_0,r_1$的某一线性组合，而$r_0=a,r_1=b$，于是得证（应该算得证吧？）。



进一步地，我们能不能设一个通式去表示$r_k$？形如$r_k=x_{k-i}r_{k-i-1}+ y_{k-i}r_{k-i}$

再探索该式中的$x_{k-i}$和$y_{k-i}$（贝祖数）是否存在通式或者递推关系式？

当$i=1$时，因为$r_k = r_{k-2}-q_{k-1}r_{k-1}$，所以显然有$\begin{cases} x_{k-1}=1 \\ y_{k-1}=-q_{k-1} \end{cases}$。

当$i=2$时，求递推过程如下：
$$
\begin{align}
r_k & = x_{k-1}r_{k-2} + y_{k-1}r_{k-1} \\
& = x_{k-1}r_{k-2} + y_{k-1}(r_{k-3} - q_{k-2}r_{k-2}) \\
& = y_{k-1}r_{k-3}+(-y_{k-1}q_{k-2} + x_{k-1}) r_{k-2}
\end{align}
\Longrightarrow
\begin{cases} x_{k-2}=y_{k-1} \\ y_{k-2}=x_{k-1}-y_{k-1}q_{k-2}\end{cases}
$$
当$i=t$时，求更一般的递推式，如下：
$$
\begin{align}
r_k & = x_{k-t+1}r_{k-t} + y_{k-t+1}r_{k-t+1} \\
& = x_{k-t+1}r_{k-t} + y_{k-t+1}(r_{k-t-1} - q_{k-t}r_{k-t}) \\
& = y_{k-t+1}r_{k-t-1}+(-y_{k-t+1}q_{k-t} + x_{k-t+1}) r_{k-t}
\end{align}
\Longrightarrow
\begin{cases}
x_{k-t}=y_{k-t+1} \\ 
y_{k-t}= x_{k-t+1} - y_{k-t+1}q_{k-t}
\end{cases}
$$
当$i=k-1$时，此时$i$带入通式即为$r_k=x_1r_0+y_1r_1$，也就是我们最初的目标$\gcd(a,b)=xa+yb$
$$
\begin{cases} 
x_{1}=y_{2} \\ 
y_{1}=x_{2} - y_{2}q_{1}
\end{cases}
$$
某种程度上，我们也算是得到了贝祖数的递推关系式。（虽然有点绕，而且相较于高中常接触的数列而言方向还反过来了）



> 19年的一个新闻，“15岁女生参加世界顶尖科学家大会，是现场最年轻科学家”，（部分xx）媒体的报导……一言难尽。
>
> 当然，个人没有嘲讽女生的意思，一来人家初中跟我本科一个水平，咱也没资格叭叭，而来人家也没想到会被大肆报道，然后搞得这么尴尬。

其研究内容是斐波那契数列和贝祖数的关系，即用扩展欧几里得算法得到关于$ax+by=d$的特解$x^*,y^*$的上下界如下（$F_n$为斐波那契数列）[^7]：
$$
\begin{align}
& F_{n-1} \leq |x^*| \leq \frac b {2d} - \frac {F_{n-2}} 2 \\
& F_{n} \leq |y^*| \leq \frac a {2d} - \frac {F_{n-1}} 2 
\end{align}
$$
借此对定理7的描述中重新描述，正向推演$x_i,y_i$数列的递推表达式：
$$
\begin{align}
ax+by &= \gcd(a,b) \\
&=\gcd(b,a \mod b) \\
&=bx'+(a-[\frac a b] b)y' \\
&=ay'+b(x'-[\frac a b]y')
\end{align}

\Rightarrow

\begin{cases} 
x=y' \\ 
y=x'- [\frac a b]y'
\end{cases}

\Rightarrow

\begin{cases} 
x_n=y_{n-1} \\ 
y_n= x_{n-1} - y_{n-1}q_n
\end{cases}
$$
$x_n,y_n$即$x^*,y^*$，很显然，$x_n$和$y_n$本质上是同一个数列，所以只需考虑$y_n$即可：
$$
y_n = y_{n-2} - q_ny_{n-1}
$$
下界$F_n \leq |y_n|$比较简单，限于个人水平只简单证（摘）明（抄）下界，上界证明可参考引文，数列$\{y_n\}$正负相间，

用数学归纳法，对$y_n>0,y_{n-1}<0,y_{n-2}>0$的情况有：
$$
\begin{align}
y_n & = y_{n-2}-q_ny_{n-1} \\
&\geq F_{n-2}+q_nF_{n-1} \\
&\geq F_{n-2}+F_{n-1} \\
&=F_n
\end{align}
$$
同样另一种情况可证得$y_n \leq -F_n$，即$F_n\leq|y_n|$.



> 2002、2003连续两年的满分金牌得主付云皓嘲讽：一边是教育部玩命打压竞赛，另一边是一个15岁小孩写个竞赛练习题的结论能上官微。



## 互质关系

$\gcd(a,b)=1$，则称$a$和$b$互素/互质。

**定理8**[^4]：整数$a$和$b$互素的充要条件是存在整数$x$和$y$使得$ax+by=1$

> 这应该只算是定理7的推论，等式$\gcd(a,b)=xa+yb$两边都除以$\gcd(a,b)$。
>
> 右边得到$ax_0+by_0$，显然有$x_0,y_0$互质，左边得到1.

另一个角度解释充分性：若存在$a,b$公因子$c$，显然对任意的$ax+by$都有因子$c$，又有$ax+by=1$，所以$c\,|\,1$，所以$c=1$。



其他一些简单的互质关系：

1. 任意两个质数构成互质关系，比如13和61。

2. 一个数是质数，另一个数小于前者或不是前者的整数倍，两者构成互质关系，比如7和6，3和10。
3. 1和任意一个自然数是都是互质关系。
4. p是大于1的整数，则p和p-1构成互质关系。
5. p是大于1的奇数，则p和p-2构成互质关系。



# 同余和一次同余方程

定义$a$与$b$模$m$同余，记作$a \equiv b(\mod m)$.

整数$a$再模$m$同余关系下的等价类（集合论-等价关系与划分）记作$[a]_m$，称为$a$的模$m$等价类。

> 关于恒等号$\equiv$和等于号=的区别，一般含参的表达式中，等号表示在给定参数下，等式左右相等，恒等号$\equiv$表示不论参数取何值该等式一直满足。

**性质19.14**[^4]：$a\equiv b(\mod n) \Leftrightarrow ca\equiv cb(\mod n)$

> 还没想通证明，姑且记着……



设$m>0$，如下所示方程称作一次同余方程（可以对比一元一次方程$ax=c$），
$$
ax \equiv c (\mod m)
$$
**定理9**[^4]：方程有解的充要条件是$\gcd(a,m)|c$

证明：存在解$x_0 \Leftrightarrow \exist x_0 \exist y_0(ax_0+my_0=c) \Leftrightarrow  \gcd(a,m)|c$

> 可以将模$m$理解为定理7表达式$ax+by=c$中的$b$。（"模$m$“类似"$+my$"的逆过程）



同时，若方程有解$x_0$，那么显然所有和$x_0$模$m$同余的数都是解。所以在求解时，只需遍历模$m$的等价类。



若$ab\equiv1(\mod m)$，则称$b$为$a$的模$m$逆。记作$a^{-1}(\mod m)$或$a^{-1}$。

$a$的模$m$逆就是同余方程$ax\equiv1(\mod m)$的解。

**定理10**[^4]：

1. $a$的模$m$逆存在的充要条件是$a$与$m$互素。

   > 即定理7中的$a,m$互素$\Leftrightarrow \exist x \exist y(ax+my=1),(x,y\in Z)$

2. 设$a$与$m$互素，则在模$m$下$a$的模$m$逆是唯一的，即$a$的任意两个模$m$逆都模$m$同余。



# 欧拉定理和费马小定理

## 欧拉函数

对于任意正整数n，把$\{0,1,\dots,n-1\}$中与$n$互素的个数记作$\phi(n)$，称为欧拉函数。

当$n$为素数时，$\phi(n)=n-1$，当$n$为合数，且已知因数分解式$n=p_1^{r_1}p_2^{r_2}\dots p_k^{r_k}=\prod_{i=1}^k p_i^{r_i}$时，$\phi(n)$有如下计算方法：
$$
\phi(n)=\prod_{i=1}^k p_i^{r_i-1} (p_i-1)=n\prod _{i=1}^k (1-\frac 1 {p_i})
$$
但对于大数（合数）的因数分解式并不容易求得，甚至后文提到RSA公钥密码体制的安全性就是基于大整数的因数分解的困难性。

### 欧拉函数的其他性质

* 如果正整数$n>2$，那么$\phi(n)$是偶数
* $n|N \Rightarrow \phi(n)|\phi(N)$
* $n|\phi(a^n-1),(n,a \in N^+)$
* 等等



## 欧拉定理

**定理11（欧拉定理）**[^4]：设$a$与$n$互素，则
$$
a^{\phi(n)} \equiv 1 (\mod n)
$$

> 第一次看到确实有点amazing

证明：

1. 最小正缩系$\Phi_0=\{r_1,r_2,\dots,r_{\phi(n)}\}$
2. 用反证法证得$\Phi_1=a\Phi = \{ar_1,ar_2,\dots,ar_{\phi(n)}\}$也是一个模$m$缩系，即$\Phi_0\rightarrow \Phi_1$的映射$\tau$是单射

若有$i \neq j,\tau(i)=\tau(j)$，则有$ar_i \equiv aj_i (\mod n)$，由性质19.14，两边同乘$a^{-1}$（$a^{-1}$也与$n$互素）得到$r_i\equiv r_j(\mod n)$，矛盾，原命题得证。

从两个正缩系可得到如下等式：
$$
\prod_{i=1}^{\phi(n)} r_i \equiv \prod_{i=1}^{\phi(n)}ar_i \equiv a^{\phi(n)}\prod_{i=1}^{\phi(n)} r_i(\mod n)
$$
因为$\gcd(n,\prod_{i=1}^{\phi(n)} c_i)=1$，于是两边消去$\prod_{i=1}^{\phi(n)} c_i$ 得到：
$$
a^{\phi(n)} \equiv 1(\mod n)
$$


练习题[^8]：

* 求正整数 $3^{83}$的最后两位数

$$
\phi(100) = n\prod_{i=1}^k (1-\frac 1 {p_i}) = 40
$$

$$
3^{83}=3^3 \times 3^{80} = 3^3 \times (3^{\phi(100)})^2 = 27 (\mod 100)
$$

* 求$2014^{2014^{2014}}$的最后两位数

同理25和2014互素，
$$
2014^{2014^{2014}} \equiv 2014^{2014^{2014} \mod 20} (\mod 25)
$$
对于$2014^{2014} \mod 20$有
$$
2014^{2014^2 \times (2014^{\phi(5)})^{503} }\equiv2014^2=16 (\mod  5)
$$
最后
$$
2014^{2014^{2014}} \equiv 2014^{16} \equiv 14^{16} \equiv 36 (\mod 100)
$$


> 欧拉函数、欧拉公式、欧拉定理
>
> 欧拉公式：$e^{ix}= \cos x + i \sin x$，特别地，$x=\pi ,e^{i\pi}+1=0$



## 费马小定理

**定理12（费马小定理）**：欧拉定理素数版，设$p$是素数，则
$$
a^{\phi(p)}=a^{p-1} \equiv 1 (\mod p)
$$
费马小定理提供了一种不用因数分解就能肯定一个数是合数的途径。



# CS中的应用

## 伪随机数



## 公钥和私钥-RSA算法

### 从对称加密到非对称加密

传统密码的密钥是对称的，通常只要知道加密密钥就能反向推算出解密密钥。于是带来了很多不足。

* 不仅解密密钥不能泄露，加密密钥也一样不能泄露，仅限于通信双方得知
* 需要另有一条特殊的信道用于交换密钥（这一条其实还是为了保证上一条）
* 显然，这样的密钥不可能多方共用，其中任意一方都可以泄密



于是非对称加密算法应运而生。

其核心，或者说神奇之处，在于明明通过两个密钥完成了一个互逆的计算过程，解密密钥却无法通过加密密钥获取，或者说能从数学层面能够证明通过加密密钥获取解密密钥是极难的，因而可以索性将加密密钥公开，称为公钥。

> 当然并不是真的无法破解。以RSA算法为例，
>
> 如果愿意动用目前全球所有算力算上几万年，大概还是可以破解的。



* 甲将公钥公布
* 所有人可以将信息通过公钥加密后发送给甲，甲通过私钥解密，其他人没有私钥即使截获密文也无法解密
* 甲通过私钥加密信息传给其他人，其他人没有私钥，无法伪造成甲发送信息



### RSA算法[^4]

RSA的基础是欧拉定理，它的安全性依赖于大数因子分解的困难性。

取两个大素数$p,q$，有$n=pq,\phi(n)= pq(1-\frac 1 p)(1- \frac 1 q) =(p-1)(q-1)$

取正整数$w$，与$\phi(n)$互素，$d$为$w$的模$\phi(n)$的逆。

1. 将明文分段并数字化，且每个明文段值$m$小于$n$
2. 加密：$c= E(m) = m^w \mod n$
3. 解密：$m = D(c) = c^d \mod n$

其中$w,n$是公开的，$p,q,\phi(n),d$保密。

> 显然，$d,w$是对称的，互逆的，在$(n,w),(n,d)$中任选一个选为公钥，另一个则为私钥。
>
> 显然在没有$\phi(n)$的情况下，无法通过公钥$w$推出私钥$d$，而分解$n$又是在实际中不太可能的。



证明：

要证明$m=c^d \mod n$，即证明$c^d \equiv m(\mod n)$，亦即证明$m^{wd} \equiv m(\mod n) $

若$m,n$互素，因为存在$k$使得$dw = k\phi(n)+1 $，所以由欧拉定理可直接证明$m^{wd} \equiv m^{k\phi(n)+1} \equiv m (\mod n)$

若$m,n$不互素，$m$必包含$p,q$其中一个为因子。不妨设$m=cp$ 且$q \nmid m$，

由费马小定理，有$m^{k\phi(n)} \equiv m^{k(p-1)(q-1)} \equiv 1^{k(p-1)} \equiv 1(\mod q)$

即存在$h$使得$m^{k\phi(n)} =hq+1 \Rightarrow m^{k \phi(n) +1}=hcn + m \Rightarrow m^{dw} \equiv m(\mod n)$，证毕。



# 数论经典简介

## 黎曼猜想

> 如果能在 500 年后重返人间,要问的第一件事情,就是黎曼猜想被证明了还是被证伪了。——希尔伯特



# 其他

> 数学史上有哪些很有可能成立的公式形式的猜想，突然被某个大数证明该猜想不成立的情况？[^1][^2]

* **Pólya conjecture**[^3]

考虑对自然数列的质因数分解，$2 = 2,3 = 3,4 = 2 × 2\dots$

Pólya猜想：对每一个给定不小于2的正整数n，$2,3,……,n$这n个数中含偶数个质因数的数的个数小于一半，即令$f(n)\equiv r_1+r_2+\dots+r_k(\mod 2)$，（$r_i$是算数基本定理中的指数），则有
$$
\sum_2^n f(x) \leq \frac{n-1}2
$$
这个猜想对一亿以内的数都成立。不幸的是，1960 年，R. Sherman Lehman 给出了一个确凿的反例：n = 906 180 359。而 Pólya 猜想的最小反例则是到了 1980 年才发现的：n = 906 150 257。



* **Perrin素数**

尝试寻找到一个简单而高效的素数生成公式一直是人们的理想之一。

Perrine发现如下数列：
$$
a_n = a_{n-2} + a_{n-3},n>2 
$$
$a_0=3,a_1=0,a_2=2$，则有

![img](C:/Users/Five/Desktop/note/img/997b7c2849e960c75811add95f4ff017_1440w.jpg)

观察发现，对于素数$k$，总有$a_k$是$k$的整数倍。这不仅能观察到，而且已经被证明了。

反过来，观察并猜想：$a_n$是$n$的倍数，当且仅当$n$是一个素数。

事实上，对于n<100000,猜想均成立，直到 1982 年， Adams 和 Shanks 才发现第一个反例 n = 271 441 ，它等于 521 × 521 ，却也能整除 f(271 441)



但还是存在数列能生成素数，如[^2]
$$
a_n={a_{n-1}+\gcd (n,a_{n-1})}
$$


* **费马大定理的推广**

费马大定理，当$n>2$时，关于$x,y,z$的方程$x^n+y^n=z^n$没有整数解。1995年由怀尔斯证明成立。

Euler曾经猜想：对于$k>2,n>k$，方程$x_1^n+x_2^n+\dots+x_k^n=y^n$都没有整数解。

反例：当$k=3,n=4$，即$x^4+y^4+z^4 = w^4$有正整数解$2682440^4+15365639^4+18796760^4=20615673^4$



* **费马数**

若$2^n+1$为素数，其必要条件是$n$为2的幂（证明略，可参考引用[^3]）。

反过来是否可行，即必要条件是否是充要条件呢？

1640年费马试到了$F(4)$，发现都满足，而$F(5)=2^{2^5}$太大了费马不算了，直接猜想：$F(n)=2^{2^n}+1$都是质数。

尴尬的是，1732年，Euler算了$F(5)$并给出了因式分解$F(5)=641\times 6700417$……

更尴尬的是，后计算机诞生，发现对于$F(x)$，从5开始到46都是合数……甚至有人反过来猜想……

> 隐约记得高中数学老师小玉讲，有一年一个数学高考题好像要“试根”，但这个要试的根比较离谱，好像是4，大部分$\pm 1,\pm 2$一试，不行，然后果断放弃。
>
> 但！总有耐心好的勇士，硬试$\pm 3$，头破血流，然后……笃定试根此路不通……然后……



* **梅森数**

与费马数类似，如果$2^n-1$是素数，那么$n$为素数为必要条件。

> 引文里因为该证明与费马数证明类似，故只给了费马数的证明，那我尝试给出梅森数的证明作为复习。

若$n$为合数，则有$n=ab$，尝试对$2^{ab} - 1$分解因式，猜测其中一个因式为$2^a-1$，即$2^{ab}-1=(2^a-1 )(\dots)$

这里的$2$其实不重要，设（或者说扩展）为$x$，则可以从高位依次开始分解出另一个因式：
$$
x^{ab}-1 = (x^a-1)(\dots)
=(x^a-1)(x^{a(b-1)}+\dots)
$$
注意到取得另一个因式的最高位$x^{a(b-1)}$后，其与$-1$相乘又多出了一项$-x^{a(b-1)}$，所以继续引入：
$$
\begin{align}
x^{ab}-1 = &(x^a-1)(\dots)\\
&(x^a-1)(x^{a(b-1)}+\dots)\\
&(x^a-1)(x^{a(b-1)}+ x^{a(b-2)} +\dots)
\end{align}
$$
重复，直到：
$$
\begin{align}
x^{ab}-1 = &(x^a-1)(\dots)\\
&(x^a-1)(x^{a(b-1)}+\dots)\\
&(x^a-1)(x^{a(b-1)}+ x^{a(b-2)} +\dots)\\
&(x^a-1)(x^{a(b-1)}+ x^{a(b-2)}+ x^{a(b-3)} +\dots + 1)
\end{align}
$$
分解完毕，也证毕。还可以注意到$a,b$是可以互换的，即$2^{ab}-1$还能分解成
$$
(x^b-1)(x^{b(a-1)}+ x^{b(a-2)}+ x^{b(a-3)} +\dots + 1)
$$
回到主线，所以$n$为素数这个必要条件能变成充要条件吗？

这个反例的出现数字并不大，$n=11$的时候就有反例，$2^{11}-1=2017=23 \times 89$

那是否存在无穷多个梅森素数？





[^1]:知乎 https://www.zhihu.com/question/37164066
[^2]:https://oeis.org/A132199，[The On-Line Encyclopedia of Integer Sequences](http://oeis.org/)
[^3]:https://www.zhihu.com/question/37164066/answer/71589759
[^4]:离散教材，屈婉玲、耿素云、张立昂
[^5]:素数定理的介绍+非常简单的推导https://zhuanlan.zhihu.com/p/114662915
[^6]:数论问题困难性的根源是什么？https://www.zhihu.com/question/23252228/answer/577734955
[^7]:lsh的回答 - 知乎 https://www.zhihu.com/question/353132524/answer/877674033
[^8]:初等数论笔记Part 1： 欧拉定理https://zhuanlan.zhihu.com/p/35060143