# 微分方程的前世今生

> 从总体思想来讲，任何积分过程的目的都在于按其已知的**局部的**特征来建立所考虑对象的**总和的、整体的**特征。这个方向的问题在以数学分析为工具的任何应用科学中都是大量存在着的。[^2]
>
> 然而，这类问题对数学工具的多种多样的要求远非积分这样一些初等工具所能满足的。这种最简单的积分工具只在较少的最原始的情形下才对解决所提出的问题适用[^2]
>
> 更常见的情况是：所研究现象的已知的局部特征能够建立**微分方程**（联系自变量、函数及其不同阶导数的方程），其中的未知量恰恰是描述该现象的整体特征的函数。[^2]
>
> 求解所提的问题从数学上转化为解某个微分方程组，即归结为定出含于这些方程中的未知函数。这个数学问题比简单地求函数的积分要复杂得多，后者从微分方程理论的观点看只是其最简单且平凡的特例。[^2]





# 常微分方程初步[^3][^1]

> 现在，微分方程的研究已相当广泛。这些问题很难求解，事实上，基本是不可能求解的, 至少一般是这样的。幸运的是，有一些简单的类型解起来并不很麻烦。[^3]

常微分的“常”是指仅含**一个自变量**的微分方程和方程组，与偏微分相对。

一般地，一个微分方程的阶是其所包含的最高阶导数的阶，如下式是一个四阶方程：
$$
x^2 \frac {\mathrm d^4 y} {\mathrm d x^4} + \sin (x) \frac {\mathrm d ^2 y} {\mathrm d x^2}(\frac {\mathrm d y} {\mathrm d x})^7 + e^x y = \tan (x)
$$

## 一阶微分方程

就考研水平涉及的而言，基本都是从可分离变量型一步步拓展出来的。



### 可分离变量方程

如方程 $\frac {\mathrm d y} {\mathrm d x} = ky $ 可通过移项化为 $\frac 1 { ky } \mathrm d y = \mathrm d x $ 的形式（这么做会有常数解丢失），两边积分即可得到结果。

再考虑如下式子
$$
\frac {\mathrm d y} {\mathrm d x} -\cos^2y \cos x =0
$$
分离变量、积分，可得 $\tan y = \sin x  + C$ ，但需要考虑 $\sec ^2 y$ 有周期 $\pi$ （或者说 $\tan y$ 有周期 $\pi$），即最终的全解应为
$$
y = \tan ^{-1} (\sin (x) + C) + n\pi
$$

> 关于 $\arctan$ 和 $\tan ^{-1}$ 的差异，有的认为 $\tan ^{-1} x = \arctan x + n\pi$。但也有认为两者一样，俺也有点糊涂。但好像又不是很重要。

其次，在求解时除以 $\cos ^2y$ ，所以会丢失常数解 $y = n\pi /2$（其中n为奇数）。

若给定初始条件 $y(\frac \pi 4) = 0$，则有 $C=1,n=0$ ，但若给定初始条件 $y(\frac {5\pi} 4) = 0$ ，则有 $C=1,n=1$



### 齐次方程

$$
\frac {\mathrm d y} {\mathrm d x} = f(\frac y x) \\
\frac {\mathrm d y} {\mathrm d x} = f(\frac x y) 
$$

形如上式的方程称为一阶齐次方程。

令 $u = \frac y x$ 或 $u = \frac x y$，以前者为例，则有 $y = ux$ ，带入可使得方程转化为变量可分离型。
$$
\frac {\mathrm d y} {\mathrm d x} = \frac {\mathrm d u} {\mathrm d x} x + u
$$


### 一阶线性方程

$$
\frac {\mathrm d y} {\mathrm d x} + p(x)y = q(x)
$$

形如上式， $y$ 和 $\frac {\mathrm d y} {\mathrm d x}$ 的幂次都是1，称为一阶**线性**方程。

可通过如下操作将一阶线性方程化为**类似“可分离变量型”的形式**。（相比于齐次方程而言会复杂一些）
$$
\begin{align}

&\mathrm {1.两边同乘以dx和积分因子：} e^{\int p(x) \mathrm d x} {\mathrm d y}  + e^{\int p(x)\mathrm d x}p(x) y  \mathrm d x= e^{\int p(x)\mathrm d x} q(x) \mathrm d x \\ \\

&\mathrm {2.凑积分：} e^{\int p(x) \mathrm d x} {\mathrm d y}  + y  \mathrm d (e^{\int p(x)\mathrm d x})= e^{\int p(x)\mathrm d x} q(x) \mathrm d x \\ \\

&\mathrm {3.乘积求导逆用：} \mathrm d (e^{\int p(x) \mathrm d x} y ) =  e^{\int p(x)\mathrm d x} q(x) \mathrm d x 

\end{align}
$$

不难发现一阶线性方程求解的核心为如下微分：
$$
\mathrm d ( e^{y\int p(x)\mathrm d x}y ) = e^{\int p(x)\mathrm d x} (\mathrm dy +  p(x)y \mathrm dx ) = e^{\int p(x)\mathrm d x} \mathrm dy +  p(x) y \cdot e^{\int p(x)\mathrm d x}\mathrm dx
$$
或者稍稍换下视角，从求导而不是微分的角度，那么核心就是乘积的求导法则。
$$
(uv)' =  uv' + u'v \\
u = e^{\int p(x) \mathrm d x} , v= y
$$

> 也就是说这个所谓的**积分因子** $u$ 求导结果应该是他自身的基础上再多出个 $p(x)$ ，故很容易联想指数函数，且指数是 $\int p(x) \mathrm d x$ .

也可归结为如下通解：
$$
y = \frac {\int e^{\int p(x)\mathrm d x} q(x) \mathrm d x + C} {e^{\int p(x) \mathrm d x} } + = e^{- \int p(x) \mathrm d x} (\int e^{\int p(x)\mathrm d x} q(x) \mathrm d x + C)
$$


#### 伯努利方程

先来看如下一道一阶线性方程的题：
$$
\frac {\mathrm d y} {\mathrm d x } + p(x)  = e^{-y}  p(x)
$$
求解该题只需两边乘以 $e^y$，再经过一次令 $u = e^y$ 的换元，即可转换到一般的一阶线性方程求解。

伯努利方程与该题有些异曲同工之妙，伯努利方程的形式为（其中 $n \ne 0,1$）：

$$
\frac {\mathrm d y} {\mathrm d x} + p(x)y = q(x) y^n 
$$
作如下变形：
$$
y ^{-n} \frac {\mathrm d y}{\mathrm d x}+ p(x) y^{1-n} = p(x)
$$
显然由凑微分可知 $ y^{-n} \mathrm d y = \frac{1}{1-n} \mathrm d (y^{-n+1}) $ ，于是作换元令 $z = y^{1-n}$ （或者令 $u=y^{1-n}$），得到
$$
\frac 1 {1-n}\frac {\mathrm d z} {\mathrm d x} + p(x) z= q(x)
$$
即转化为了一阶线性方程。





### 二阶可降阶微分方程

#### 方程中不显含y

$$
y'' = f(y',x)
$$

形如上式，不显含x的二阶微分方程可通过降阶求解。

只需将目标从求解表达式 $y(x)$ 转变为求解表达式 $y'(x)$，即原二阶方程转化为 $\frac {\mathrm d y'} {\mathrm d x}$ 的一阶微分方程（ $y'$ 视为一个船新的因变量，而不是谁的导数）。



#### 方程中不显含x

$$
y'' = f(y',y)
$$

形如上式，不显含x的二阶微分方程可通过降阶求解。令 $g = y'$，则有
$$
y '' = \frac {\mathrm d g}{\mathrm d x } =  \frac {\mathrm d g} {\mathrm d y} \frac {\mathrm d y} {\mathrm d x}  = g \frac {\mathrm d g} {\mathrm d y}
$$
则 $y'' = f(y,y') $ 型的微分方程可改写为 $g \frac {\mathrm d g} {\mathrm d y} = f(y,g)$，即原二阶微分方程转换为 $\frac {\mathrm dg} {\mathrm d y} $ 的一阶微分方程。

解该一阶微分方程可得到 $g = \varphi(y , C_1)$，再将 $g = \frac {\mathrm d y} {\mathrm d x}$ 带回即可再得到一个 $\frac {\mathrm d y}{ \mathrm dx}$ 的一阶微分方程 $ \frac {\mathrm d y}{ \mathrm dx} = \varphi(y,C_1)$，而且是可分离变量的一阶微分方程。



### 其他

$$
\frac {\mathrm d y} {\mathrm d x} = f(ax + by + c)
$$







## 高阶微分方程

### 线性微分方程和线性空间







### 二阶常系数线性微分方程

$$
y'' + py' + qy = f(x)
$$

#### 齐次

若 $f(x) \equiv 0$ 则称为齐次。

> 显然，二阶常系数线性微分方程是之前提到的不显含 x 的可降阶微分方程的更特殊形式。

可以假设 $y = e^{\lambda x}$，则
$$
y'' + py' + qy = 0 \\

e^{\lambda x} (\lambda ^2 + p \lambda + q) = 0
$$
解一元二次方程得到两个根 $\lambda _1 ,\lambda _2$，带回得到两个解。



#### 非齐次

特解+齐次

当自由项 $f(x) = P(x) e^{ax}$ 时，特解设为 $y^* = e^{\alpha x} Q_n(x)x^k$，其中 $Q(x)$ 是 x 的n 次多项式



当自由项 $f(x) =  e^{\alpha x }[P_m(x) \cos \beta x + P_n(x) \sin \beta x]$ 时，特解设为
$$
y^* = e^{\alpha x } [Q^{(1)}_l (x) \cos \beta x +Q_l ^{(2)}(x) \sin \beta x] x^k
$$






### 二阶变系数线性微分方程

$$
y'' + p(x) y' + q(x) y = f(x)
$$

> 显然，二阶常系数线性微分方程是变系数线性微分方程当 $p(x),q(x)$ 均为常数函数时的特例。

#### 齐次



#### 非齐次







### 其他

#### 欧拉方程

$$
x^2 \frac {\mathrm d^2 y} {\mathrm d x^2} + p x \frac {\mathrm d y} {\mathrm d x} + qy = f(x)
$$

形如上式的方程称为欧拉方程。

一般有固定解法。当 $x> 0$ 时，令 $x=e^t$，当 $x<0$ 时，令 $x=-e^t$。使得方程可化为如下形式
$$
\frac {\mathrm d ^2 y} {\mathrm d t ^2}  + (p-1) \frac {\mathrm  d y} {\mathrm d  x}  + qy = f(e^t)
$$
​	



# 线性微分方程和线性空间







# 模型、应用、例题

## Lotka-Volterra模型

* 猎物所接受的食物供给已经达到最极限，且除非遭遇掠食者的捕食，否则繁殖数量的增加以指数方式成长
* 猎物遭遇捕食的比例，和猎物遭遇掠食者的机会成常数比。

$$
\frac {\mathrm d x} {\mathrm d t} = x(\alpha - \beta y) \\
\frac {\mathrm d y} {\mathrm d t} = -y(\gamma - \delta x)
$$







## 例题

例题1：求下述微分方程的通解
$$
y \mathrm d x = (1+x\ln y ) x \mathrm d y
$$
提示：按照求解 $y = f(x)$ 表达式的思路来会很困难，试着**对调 $y $ 和 $x$ 的地位**，即试着求 $x = f^{-1}(y)$ 的表达式，则有 $\frac {\mathrm d x}{\mathrm dy} = \frac {(1 + x \ln y)x} {y}  = - p(y) x + q(y)x^2$ ，即是一个伯努利方程。	













# 数学系进阶要求

* 初等积分法
* 存在和唯一性定理
  * 皮卡存在和唯一性定理
  * 佩亚诺存在定理
* 奇解
* 高阶微分方程
* 线性微分方程
* 幂级数解法
* 定性理论与分支理论初步
* 边值问题
* 首次积分
* 一阶偏微分方程









[^1]: 张宇考研数学全程班
[^2]:《数学分析八讲》辛钦 著， 王会林 齐民有 译

[^3]: 《普林斯顿微积分读本》
[^4]:如何将高阶线性微分方程与线性代数联系起来？ - 東雲正樹的回答 - 知乎 https://www.zhihu.com/question/307877050/answer/1881441533
[^5]:微分方程与空间有何关系？ - 東雲正樹的回答 - 知乎 https://www.zhihu.com/question/458652755/answer/1877957587
[^6]:如何将高阶线性微分方程与线性代数联系起来？ - 贾明子的回答 - 知乎 https://www.zhihu.com/question/307877050/answer/1885678187

